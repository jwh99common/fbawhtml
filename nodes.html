<html>
<head>
    <link rel="stylesheet" href="mystyle.css">
    <link rel="stylesheet" href="news.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>       
            
            
    <div id="nav-placeholder"></div>
    <script>
        $.get("navigation.html", function(data){
            $("#nav-placeholder").replaceWith(data);
        });
    </script> 
    
    
    <style type="text/css">
        #mynetwork {
            width: 600px;
            height: 400px;
            border: 1px solid lightgray;
        }
    </style>
</head>
    
    
<body>
<div id="header">
  <p>Nodes Page</p>
</div>  
	
	
<table id="employees", align="center"></table>
	
	
<style>
* {
  box-sizing: border-box;
}

/* Create two equal columns that floats next to each other */
.column {
  float: left;
  width: 50%;
  padding: 10px;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}
</style>
    
<div class="row">
  <div class="column" style="background-color:#aaa;">
    <div id="mynetwork"></div>

<script type="text/javascript">
    // create an array with nodes
    var nodes = new vis.DataSet([
        {id: 1, label: 'Node 1'},
        {id: 2, label: 'Node 2'},
        {id: 3, label: 'Node 3'},
        {id: 4, label: 'Node 4'},
        {id: 5, label: 'Node 5'}
    ]);

    // create an array with edges
    var edges = new vis.DataSet([
        {from: 1, to: 3},
        {from: 1, to: 2},
        {from: 2, to: 4},
        {from: 2, to: 5},
        {from: 5, to: 3},
        {from: 1, to: 3}
        
    ]);

    // create a network
    var container = document.getElementById('mynetwork');

    // provide the data in the vis format
    var data = {
        nodes: nodes,
        edges: edges
    };
    var options = {};

    // initialize your network!
    var network = new vis.Network(container, data, options);
    
</script>
	 
    
  </div>
  <div class="column" style="background-color:#bbb;">
    
	<form id="myForm">
    	<input type="file" id="csvFile" accept=".csv" />
    	<br />
    	<input type="submit" value="Submit" />
  	</form>
	  
  	<script>
    	const myForm = document.getElementById("myForm");
    	const csvFile = document.getElementById("csvFile");

    	function csvToArray(str, delimiter = ",") {

	// slice from start of text to the first \n index
      	// use split to create an array from string by delimiter
      	const headers = str.slice(0, str.indexOf("\n")).split(delimiter);
	
	
      	// slice from \n index + 1 to the end of the text
      	// use split to create an array of each csv value row
      	const rows = str.slice(str.indexOf("\n") + 1).split("\n");
	

      	// Map the rows
      	// split values from each row into an array
      	// use headers.reduce to create an object
      	// object properties derived from headers:values
      	// the object passed as an element of the array
      	
	
	const arr = rows.map(function (row) {
        const values = row.split(delimiter);
	
	
        const el = headers.reduce(function (object, header, index) {
          console.log ('Header : ' + header);
	  object[header] = values[index];
	  return object;
        }, {});
	return el;
      });

      // return the array
			
      for(var i = 0; i < arr.length; i++) {
		console.log ('array : ' + i + arr[i].Name + ' ' + arr[i].Role);
	        console.log('Region : ' +     arr[i].Region + ' ' + arr[i].Salary);
	}
		
		
	let tab = 
        `<tr>
        <th>Name</th>
        <th>Office</th>
	<th>Region</th>
	<th>Salary</th>
 	</tr>`;
	
	for(var i = 0; i < arr.length; i++) {
		var r = arr[i]; 
		tab += `<tr> 
    		<td>${r.Name} </td>
    		<td>${r.Role}</td>
		<td>${r.Region}</td>
		<td>${r.Salary}</td>
		</tr>`;
    		}
		
      document.getElementById("employees").innerHTML = tab;
      return arr;
    }

    myForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const input = csvFile.files[0];
      const reader = new FileReader();

      reader.onload = function (e) {
        const text = e.target.result;
        const data = csvToArray(text);
        // document.write(JSON.stringify(data));
      };
      console.log (input.name);
      reader.readAsText(input);
	    
    });
  </script>
  

  </div>
</div>  
   

    


    
</body>
</html>
